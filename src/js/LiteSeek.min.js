/**
*  LiteSeek
*  A lite, fast and versatile fuzzy full-text search engine for PHP, JavaScript, Python
*
*  @version: 1.0.0
*  https://github.com/foo123/LiteSeek
*
**/
!function(t,n,e){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=e.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return e.moduleUri=n.uri,e.call(t)}):n in t||(t[n]=e.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"LiteSeek",function(r){"use strict";function t(){}function L(){var n=this;n.opts={},n.option("match-prefix",!1),n.option("similarity",.65),n.option("n-gram",2),n.option("filter_word",null),n.option("normalize_word",null),n.option("read_index",t),n.option("store_index",t)}function n(n,t){var e=this;e.w=String(n),e.n=e.w.length,e.k=U(u(0|(null==t?1:t),0),e.n)}L.VERSION="1.0.0",L.DELIM=/[\s\.\?,;!:\(\)\[\]@#\$%\^&\*\-_\+<>=\/\\"']/,L.DELIM_g=/[\s\.\?,;!:\(\)\[\]@#\$%\^&\*\-_\+<>=\/\\"']/g,L.SPACE=/\s+/g,L.ASCII=/^[ -~]+$/,L.prototype={constructor:L,opts:null,option:function(n,t){var e=this,o=arguments.length;return 1==o?x(e.opts,n)?e.opts[n]:r:(1<o&&(e.opts[n]=t),e)},index:async function(n,t,e){var o,r,i,u,a,l=this,s=l.option("filter_word"),c=l.option("normalize_word"),f=String(n),h=f.length,p=l.option("n-gram"),m={},d="",g=0,A=0;for(y(s)||(s=null),y(c)||(c=null),i=0;i<h;++i)if(u=f.charAt(i),L.DELIM.test(u)){if(""!==d&&(!s||await s(d,e))){for(r in a=d.length,d=c?await c(d,e):l.normalize(d,e),o=l._ngram(d,p))x(o,r)&&(x(m,r)||(m[r]=[]),m[r].push([A,d,g,a]));A+=1}d=""}else""===d&&(g=i),d+=u;if(""!==d&&(!s||await s(d,e))){for(r in a=d.length,d=c?await c(d,e):l.normalize(d,e),o=l._ngram(d,p))x(o,r)&&(x(m,r)||(m[r]=[]),m[r].push([A,d,g,a]));A+=1}return t&&await l.option("store_index")(t,m,e),m},find:async function(n,t,e,o,r){var i,u,a,l,s,c,f,h,p=this,m="[object String]"===g.call(n)?await p.index(n,null):null,d=[];if(m||"[object Array]"===g.call(n)&&n.length){for(e=!!e,o=!!o,i=String(t).replace(L.DELIM_g," ").trim().split(L.SPACE).filter(function(n){return 0<n.length}),a=[],l=p.option("filter_word"),s=p.option("normalize_word"),y(l)||(l=null),y(s)||(s=null),f=0,h=i.length;f<h;++f)u=i[f],l&&!await l(u,r)||a.push(s?await s(u,r):p.normalize(u,r));if(!a.length)return d;if(m)-1e6<(c=await p._match(null,a,e,o,r,m)).score&&d.push({document:n,query:t,score:c.score,marks:c.marks});else for(f=0,h=n.length;f<h;++f)-1e6<(c=await p._match(n[f],a,e,o,r,null)).score&&d.push({document:n[f],query:t,score:c.score,marks:c.marks});d.sort(function(n,t){return t.score-n.score})}return d},_match:async function(e,w,E,U,o,r){var I=this,_=I.option("similarity"),k=w.length,v=I.option("n-gram"),i={},S=async function(n){var t;return r?x(r,n)?r[n]:null:i&&x(i,n)?i[n]:(t=await I.option("read_index")(e,n,o))&&"[object Object]"===g.call(t)?(i=null,x(r=t,n)?r[n]:null):(i[n]=t||null,t)},z=function(n,t,e){var o,r,i,u,a,l=0;if(t&&t.length){for(o=[],r=n.length,i=t.length,a=u=0;a<i&&t[a][0]<e;)++a;for(;u<r&&a<i;)n[u][0]<t[a][0]?(o.push(n[u]),++u):n[u][0]>t[a][0]?(o.push(t[a]),++a):(o.push(n[u]),++u,++a,l=1);for(;u<r;)o.push(n[u]),++u;for(;a<i;)o.push(t[a]),++a}else o=n;return[o,l]},n=await async function n(t,e,o){if(k<=t)return null;var r,i,u,a,l,s,c,f,h=w[t],p=null,m=-2e5,d=0,g=I._ngram(h,v),A=h.length,y=j((1-_)*A),O=[];for(i in g)x(g,i)&&(O=(s=z(O,await S(i),e))[0],d+=s[1]);if(!O.length||y<A-v-d)return!1;for(r=new L.Automaton(h,y),u=0,a=O.length;u<a&&(y=(l=O[u])[0],!(U&&0<t&&o+t<y));++u)(c=(c=l[1])===h?1:E?0:r.match(c))<_||!1!==(s=await n(t+1,y+1,0===t?y:o))&&(c=e-y-10*(1-c),f=[[l[2],l[3]]],s&&(c+=s.score,f=f.concat(s.marks)),m<c)&&(p={score:m=c,marks:f});return!(0<t&&!p)&&p}(0,-1,-1);return n||{score:-2e6,marks:[]}},_ngram:function(n,t){for(var e,o=u(1,n.length-t+1),r={},i=0;i<o;++i)x(r,e=n.slice(i,i+t))||(r[e]=0),r[e]+=1;return r},normalize:function(n,t){return this.normalizeAccents(n.toLowerCase(),t)},normalizeAccents:function(n,t){var e;return L.ASCII.test(n)?n:(e={"ª":"a","º":"o","À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","ß":"s","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","ÿ":"y","Ø":"O","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Ĉ":"C","ĉ":"c","Ċ":"C","ċ":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"D","đ":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"G","ĝ":"g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"H","ĥ":"h","Ħ":"H","ħ":"h","Ĩ":"I","ĩ":"i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L","ŀ":"l","Ł":"L","ł":"l","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"n","Ŋ":"N","ŋ":"n","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":"O","ő":"o","Ŕ":"R","ŕ":"r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ŝ":"S","ŝ":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ŧ":"T","ŧ":"t","Ũ":"U","ũ":"u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ſ":"s","Ș":"S","ș":"s","Ț":"T","ț":"t","Ơ":"O","ơ":"o","Ư":"U","ư":"u","Ầ":"A","ầ":"a","Ằ":"A","ằ":"a","Ề":"E","ề":"e","Ồ":"O","ồ":"o","Ờ":"O","ờ":"o","Ừ":"U","ừ":"u","Ỳ":"Y","ỳ":"y","Ả":"A","ả":"a","Ẩ":"A","ẩ":"a","Ẳ":"A","ẳ":"a","Ẻ":"E","ẻ":"e","Ể":"E","ể":"e","Ỉ":"I","ỉ":"i","Ỏ":"O","ỏ":"o","Ổ":"O","ổ":"o","Ở":"O","ở":"o","Ủ":"U","ủ":"u","Ử":"U","ử":"u","Ỷ":"Y","ỷ":"y","Ẫ":"A","ẫ":"a","Ẵ":"A","ẵ":"a","Ẽ":"E","ẽ":"e","Ễ":"E","ễ":"e","Ỗ":"O","ỗ":"o","Ỡ":"O","ỡ":"o","Ữ":"U","ữ":"u","Ỹ":"Y","ỹ":"y","Ấ":"A","ấ":"a","Ắ":"A","ắ":"a","Ế":"E","ế":"e","Ố":"O","ố":"o","Ớ":"O","ớ":"o","Ứ":"U","ứ":"u","Ạ":"A","ạ":"a","Ậ":"A","ậ":"a","Ặ":"A","ặ":"a","Ẹ":"E","ẹ":"e","Ệ":"E","ệ":"e","Ị":"I","ị":"i","Ọ":"O","ọ":"o","Ộ":"O","ộ":"o","Ợ":"O","ợ":"o","Ụ":"U","ụ":"u","Ự":"U","ự":"u","Ỵ":"Y","ỵ":"y","ɑ":"a","Ǖ":"U","ǖ":"u","Ǘ":"U","ǘ":"u","Ǎ":"A","ǎ":"a","Ǐ":"I","ǐ":"i","Ǒ":"O","ǒ":"o","Ǔ":"U","ǔ":"u","Ǚ":"U","ǚ":"u","Ǜ":"U","ǜ":"u","Ά":"Α","ά":"α","Έ":"Ε","έ":"ε","Ή":"Η","ή":"η","Ί":"Ι","ί":"ι","Ϊ":"Ι","ϊ":"ι","ΐ":"ι","Ό":"Ο","ό":"ο","Ύ":"Υ","ύ":"υ","Ϋ":"Υ","ϋ":"υ","ΰ":"υ","Ώ":"Ω","ώ":"ω","ς":"σ"},"ca"===t&&(e["l·l"]="ll"),Object.keys(e).reduce(function(n,t){return n.split(t).join(e[t])},n))}},n.prototype={constructor:n,w:"",n:0,k:1,initial:function(){return[i(0,this.k,1),i(0,this.k,1),[],[],""]},transition:function(n,t){var e,o,r,i,u,a=this.k,l=this.w,s=this.n,c=n[0],f=n[1],h=[],p=[],m=c.length,d=n[2],g=n[3],A=d.length,y=-1,O=0,w=0,E=n[4];for(0<m&&0===c[0]&&f[0]<a&&(O=i=f[y=o=0]+1,h.push(o),p.push(i)),r=0;r<m&&!(s<=(o=c[r]));++r){if(u=l.charAt(o)===t?0:1,i=f[r]+u,e=r+1<m?c[r+1]:-1,++o-1===y&&(i=U(i,O+1)),o===e&&(i=U(i,f[r+1]+1)),E===l.charAt(o-1)&&t===l.charAt(o-2)){for(;w<A&&d[w]<o-2;)++w;w<A&&o-2===d[w]&&(i=U(i,g[w]+u),++w)}i<=a&&(y=o,O=i,h.push(o),p.push(i))}return[h,p,c,f,t]},terminal:function(n){var n=n[0],t=n.length;return 0<t&&n[t-1]===this.n},match:function(n,t){var e,o,r;for(null==t&&(t=this.initial()),e=0,o=n.length;e<o;++e)if(r=n.charAt(e),!(t=this.transition(t,r))[0].length)return 0;return this.terminal(t)?1-t[1][t[1].length-1]/this.n:0}},L.Automaton=n;var e=Math,U=e.min,u=e.max,j=(e.floor,e.round),o=Object.prototype.hasOwnProperty,g=Object.prototype.toString;function y(n){return"function"==typeof n}function x(n,t){return o.call(n,t)}function i(n,t,e){null==e&&(e=1);for(var o=[];n<=t;)o.push(n),n+=e;return o}return L});